var OM;!function(OM){var CustomWebParts;!function(CustomWebParts){var _config={wp_class:".custom-webpart",linkedit_selector:".ms-rte-embedcode-linkedit",hiddeninput_selector:".aspNetHidden input",toolpane_selector:".ms-TPBody"},Util;!function(t){function e(){return jQuery(_config.wp_class)}function n(t,e,n){return t?t.replace(new RegExp(e,"g"),n):""}function r(t){var e=n(t,"-","_");return jQuery(_config.toolpane_selector+"[id*='"+e+"']").first()}function i(t){return jQuery(_config.hiddeninput_selector+"[name*='"+t+"']")}function o(t,e){return t.map(function(t){return String.format("<option{0}>{1}</option>",t==e?" selected":"",t)}).join("")}function a(t){var e=t.data("webpart-properties")[0];return Object.keys(e).forEach(function(t){var n=jQuery("input.UserInput[name*='EditorZone'][name*='"+t+"'], select.UserSelect[name*='EditorZone'][name*='"+t+"']"),r=n.prop("tagName");switch(r){case"INPUT":switch(n.attr("type")){case"text":e[t]=n.val();break;case"checkbox":e[t]=n.prop("checked").toString()}break;case"SELECT":e[t]=n.val()}}),t.attr("data-webpart-properties","["+JSON.stringify(e)+"]"),jQuery("<div>").append(t.clone()).html()}function d(t){window.hasOwnProperty("console")&&window.console.info&&console.info(t)}function l(t){window.hasOwnProperty("console")&&window.console.error&&console.error(t)}function s(){var t="string"==typeof window.MSOWebPartPageFormName?window.MSOWebPartPageFormName:"aspnetForm",e=window.document.forms[t];return!(!e||!(e.MSOLayout_InDesignMode&&e.MSOLayout_InDesignMode.value||"function"==typeof window.MSOLayout_IsWikiEditMode&&window.MSOLayout_IsWikiEditMode()))}function c(e){var n=e.properties[0],d=r(e.id[1]);if(Object.keys(n).length>0&&d.length>0){jQuery(_config.linkedit_selector).hide();for(var l=[],s=0;s<Object.keys(n).length;s++){var c=Object.keys(n)[s],_=n[c];if(null!=e.instance.data("webpart-choices")&&null!=e.instance.data("webpart-choices")[c]){var u=o(e.instance.data("webpart-choices")[c].split(","),_);l.push(String.format(Templates.Field_Choice,t.ReplaceAll(e.id[1],"-","_"),c,u))}else"true"==_||"false"==_?l.push(String.format(Templates.Field_Boolean,t.ReplaceAll(e.id[1],"-","_"),c,"true"==_?"checked":"")):l.push(String.format(Templates.Field_String,t.ReplaceAll(e.id[1],"-","_"),c,_))}d.append(String.format(Templates.Container,t.ReplaceAll(e.id[1],"-","_"),l.join("")));var p=jQuery("input[type='submit'][name*='OKBtn'], input[type='submit'][name*='AppBtn']");p.click(function(){i(e.id[1]).val(a(e.instance))})}}t.GetWebPartsDefinitions=e,t.ReplaceAll=n,t.GetToolPaneForWebPart=r,t.GetHiddenInputFieldForWebPart=i,t.Log=d,t.Error=l,t.InEditMode=s,t.RenderWebPartProperties=c}(Util||(Util={}));var WebPart=function(){function t(t){this.instance=t,this.id=[this.instance.parents("div[webpartid]").first().attr("webpartid"),this.instance.parents("div[webpartid2]").first().length>0?this.instance.parents("div[webpartid2]").first().attr("webpartid2"):this.instance.parents("div[webpartid]").first().attr("webpartid")],this.renderfunction=this.instance.data("webpart-renderfunction"),this.renderevent=this.instance.data("webpart-renderevent"),this.properties=this.instance.data("webpart-properties")}return t.prototype.render=function(){Manager.Render(this)},t}();CustomWebParts.WebPart=WebPart,CustomWebParts.WebParts=[];var Templates={Container:'<div> <table cellspacing="0" cellpadding="0" style="width:100%;border-collapse:collapse;"> <tbody> <tr> <td><div class="UserSectionTitle"><a id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGEANCHOR" href="#" onkeydown="WebPartMenuKeyboardClick(this, 13, 32, event);" style="cursor:hand" onclick="javascript:MSOTlPn_ToggleDisplay(\'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory\', \'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGE\', \'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_ANCHOR\', \'Expand category: Custom\', \'Collapse category: Custom\',\'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGEANCHOR\'); return false;" title="Expand category: Custom">&nbsp;<img id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGE" alt="Expand category: Custom" border="0" src="/_layouts/15/images/TPMax2.gif">&nbsp;</a><a tabindex="-1" onkeydown="WebPartMenuKeyboardClick(this, 13, 32, event);" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_ANCHOR" style="cursor:hand" onclick="javascript:MSOTlPn_ToggleDisplay(\'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory\', \'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGE\', \'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_ANCHOR\', \'Expand category: Custom\', \'Collapse category: Custom\',\'ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory_IMAGEANCHOR\'); return false;" title="Expand category: Custom"> &nbsp;Custom</a></div></td> </tr> </tbody> </table><div class="ms-propGridTable" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_CustomCategory" style="display:none;"> <table cellspacing="0" style="border-width:0px;width:100%;border-collapse:collapse;"> <tbody>{1}</tbody> </table> </div> </div>',Field_String:'<tr><td><input type="hidden" name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl11${1}_ROWSTATE" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_ROWSTATE" value="0"><div class="UserSectionHead"><label for="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_EDITOR" title="">{1}</label></div><div class="UserSectionBody"><div class="UserControlGroup"><nobr><input name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl11${1}_EDITOR" type="text" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_EDITOR" class="UserInput" ms-tlpnwiden="true" style="width:176px;{1}:ltr;" value="{2}"></nobr></div></div><div style="width:100%" class="UserDottedLine"></div></td></tr>',Field_Boolean:'<tr><td><input type="hidden" name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl11${1}_ROWSTATE" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_ROWSTATE" value="0"><div class="UserSectionHead"><span onfocus="MSOPGrid_HidePrevBuilder()"><input id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_EDITOR" type="checkbox" name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl11${1}_EDITOR" class="UserInput" {2} onclick="MSOPGrid_HidePrevBuilder();"></span>&nbsp;&nbsp;<label for="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl11_{1}_EDITOR" title="">{1}</label></div><div style="width:100%" class="UserDottedLine"></div></td></tr>',Field_Choice:'<tr><td><input type="hidden" name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl07${1}_ROWSTATE" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl07_{1}_ROWSTATE" value="0"><div class="UserSectionHead"><label>{1}</label></div><div class="UserSectionBody"><div class="UserControlGroup"><nobr><select name="ctl00$MSOTlPn_EditorZone$Edit0g_{0}$ctl07${1}_EDITOR" id="ctl00_MSOTlPn_EditorZone_Edit0g_{0}_ctl07_{1}_EDITOR" class="UserSelect" onclick="MSOPGrid_HidePrevBuilder()" onfocus="MSOPGrid_HidePrevBuilder()">{2}</select></nobr></div></div><div style="width:100%" class="UserDottedLine"></div></td></tr>'},Manager;!function(Manager){function Init(){Util.GetWebPartsDefinitions().each(function(){try{CustomWebParts.WebParts.push(new WebPart(jQuery(this)))}catch(t){Util.Error("Error parsing webpart.")}}),RenderAllWebParts()}function RenderAllWebParts(){CustomWebParts.WebParts.forEach(function(t){t.renderevent||t.render(),ExecuteOrDelayUntilEventNotified(t.render,t.renderevent)})}function Render(webpart){if(Util.InEditMode())Util.RenderWebPartProperties(webpart);else try{eval(webpart.renderfunction+"(webpart)")}catch(e){Util.Error("The render function for one of the webparts doesn't exist, or has a syntax error.")}}Manager.Init=Init,Manager.Render=Render}(Manager=CustomWebParts.Manager||(CustomWebParts.Manager={}))}(CustomWebParts=OM.CustomWebParts||(OM.CustomWebParts={}))}(OM||(OM={})),ExecuteOrDelayUntilBodyLoaded(function(){return window._v_dictSod.jquery?void ExecuteOrDelayUntilScriptLoaded(OM.CustomWebParts.Manager.Init,"jquery"):void console.error("You need to have a SOD registered for jQuery, and ensure it's loaded.")});